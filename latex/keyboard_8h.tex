\hypertarget{keyboard_8h}{}\doxysection{include/keyboard.h File Reference}
\label{keyboard_8h}\index{include/keyboard.h@{include/keyboard.h}}


按键模块  


{\ttfamily \#include \char`\"{}base.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}interrupt.\+h\char`\"{}}\newline
Include dependency graph for keyboard.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=223pt]{keyboard_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{keyboard_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{Indent}\textbf{ K\+EY}\par
{\em 按键标号：15 11 13 9 10 3 4 14 16 12 8 7 2 1 ~\newline
对应音频： 1 2 3 4 5 6 7 1+ 2+ 3+ 4+ 5+ 6+ 7+ }\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{keyboard_8h_addc4664e1cdd8bcd41c4410001f63eca}\label{keyboard_8h_addc4664e1cdd8bcd41c4410001f63eca}} 
\#define {\bfseries K\+E\+Y\+C1}~P\+O\+R\+T\+Abits.\+R\+A3
\item 
\mbox{\Hypertarget{keyboard_8h_adc503653fb1a64678c5ade140c1ea1a8}\label{keyboard_8h_adc503653fb1a64678c5ade140c1ea1a8}} 
\#define {\bfseries K\+E\+Y\+C2}~P\+O\+R\+T\+Abits.\+R\+A4
\item 
\mbox{\Hypertarget{keyboard_8h_a012c2a640d714f1278e572f4158183df}\label{keyboard_8h_a012c2a640d714f1278e572f4158183df}} 
\#define {\bfseries K\+E\+Y\+C3}~P\+O\+R\+T\+Abits.\+R\+A5
\item 
\mbox{\Hypertarget{keyboard_8h_a94ca252872512f898dbfa88546f594db}\label{keyboard_8h_a94ca252872512f898dbfa88546f594db}} 
\#define {\bfseries K\+E\+Y\+C4}~P\+O\+R\+T\+Abits.\+R\+A6
\item 
\mbox{\Hypertarget{keyboard_8h_a59ab732f7a58e26f27d3a769b7c5fb3b}\label{keyboard_8h_a59ab732f7a58e26f27d3a769b7c5fb3b}} 
\#define {\bfseries K\+E\+Y\+C5}~P\+O\+R\+T\+Abits.\+R\+A7
\item 
\mbox{\Hypertarget{keyboard_8h_ac2c3aa4b7049ff7187e5e730b3569e96}\label{keyboard_8h_ac2c3aa4b7049ff7187e5e730b3569e96}} 
\#define {\bfseries K\+E\+Y\+M1}~P\+O\+R\+T\+Abits.\+R\+A1
\item 
\mbox{\Hypertarget{keyboard_8h_a857c4ddf08c22e6c60a429209a5dd61a}\label{keyboard_8h_a857c4ddf08c22e6c60a429209a5dd61a}} 
\#define {\bfseries K\+E\+Y\+M2}~P\+O\+R\+T\+Abits.\+R\+A0
\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ S\+C\+A\+N\+T\+I\+ME}\par
{\em 设置扫描的间隔时间，16位定时器，分高8位和低8位保存。目前定时为10ms一次扫描 }\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{keyboard_8h_ac5ad5033bbb1ed9d05099d689d55cb81}\label{keyboard_8h_ac5ad5033bbb1ed9d05099d689d55cb81}} 
\#define {\bfseries S\+C\+A\+N\+T\+I\+M\+E\+\_\+H}~0b01100011
\item 
\mbox{\Hypertarget{keyboard_8h_a231db0689db0e6223ffa19e806f59012}\label{keyboard_8h_a231db0689db0e6223ffa19e806f59012}} 
\#define {\bfseries S\+C\+A\+N\+T\+I\+M\+E\+\_\+L}~0b11000000
\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ S\+C\+AN}\par
{\em S\+C\+A\+N1：全部弱上拉：4、10、13、15、16 ~\newline
S\+C\+A\+N2：\+K\+E\+Y\+C5输出0，其余弱上拉：3、9、12、14 ~\newline
S\+C\+A\+N3：\+K\+E\+Y\+C4、\+K\+E\+Y\+C5输出0，其余弱上拉：2、8、11 ~\newline
S\+C\+A\+N4：\+K\+E\+Y\+C3、\+K\+E\+Y\+C4、\+K\+E\+Y\+C5输出0，其余弱上拉：1、7 }\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{keyboard_8h_ad2364ab89ef3ec7dac964a5c0e54db00}\label{keyboard_8h_ad2364ab89ef3ec7dac964a5c0e54db00}} 
\#define {\bfseries S\+C\+A\+N1\+\_\+\+RW}~T\+R\+I\+SA = 0b11111011
\item 
\mbox{\Hypertarget{keyboard_8h_a633b690dfa670a799215be3a522ea286}\label{keyboard_8h_a633b690dfa670a799215be3a522ea286}} 
\#define {\bfseries S\+C\+A\+N1\+\_\+\+W\+PU}~W\+P\+UA = 0b11111011
\item 
\mbox{\Hypertarget{keyboard_8h_a0dc01053497fa970c8274347d9c7e76c}\label{keyboard_8h_a0dc01053497fa970c8274347d9c7e76c}} 
\#define {\bfseries S\+C\+A\+N2\+\_\+\+RW}~T\+R\+I\+SA = 0b01111011
\item 
\mbox{\Hypertarget{keyboard_8h_ac7828ded31106e6674d1f9a58e445b6b}\label{keyboard_8h_ac7828ded31106e6674d1f9a58e445b6b}} 
\#define {\bfseries S\+C\+A\+N2\+\_\+\+W\+PU}~W\+P\+UA = 0b01111011
\item 
\mbox{\Hypertarget{keyboard_8h_a607248af5fae9e6e74d28234ab5cb2ce}\label{keyboard_8h_a607248af5fae9e6e74d28234ab5cb2ce}} 
\#define {\bfseries S\+C\+A\+N3\+\_\+\+RW}~T\+R\+I\+SA = 0b00111011
\item 
\mbox{\Hypertarget{keyboard_8h_aec4adfe13a921499d7321a6c52923067}\label{keyboard_8h_aec4adfe13a921499d7321a6c52923067}} 
\#define {\bfseries S\+C\+A\+N3\+\_\+\+W\+PU}~W\+P\+UA = 0b00111011
\item 
\mbox{\Hypertarget{keyboard_8h_a7f10a133279c567dd5fdc1196246da20}\label{keyboard_8h_a7f10a133279c567dd5fdc1196246da20}} 
\#define {\bfseries S\+C\+A\+N4\+\_\+\+RW}~T\+R\+I\+SA = 0b00011011
\item 
\mbox{\Hypertarget{keyboard_8h_a4a2fd19d3aaf132e8adf541731b2dbbf}\label{keyboard_8h_a4a2fd19d3aaf132e8adf541731b2dbbf}} 
\#define {\bfseries S\+C\+A\+N4\+\_\+\+W\+PU}~W\+P\+UA = 0b00011011
\end{DoxyCompactItemize}
\end{Indent}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902}{work\+\_\+mode\+\_\+t}} \{ \mbox{\hyperlink{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902a7f333a8f14b5817b34708afb007c91b8}{Play}}, 
\mbox{\hyperlink{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902a8783a0d68f9430756749f185ac814bc5}{Study}}
 \}
\begin{DoxyCompactList}\small\item\em 电子琴工作模式 \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{keyboard_8h_a35318cf1a2dec226a910eb3083292c16}\label{keyboard_8h_a35318cf1a2dec226a910eb3083292c16}} 
void \mbox{\hyperlink{keyboard_8h_a35318cf1a2dec226a910eb3083292c16}{T\+M\+R1\+Init}} (void)
\begin{DoxyCompactList}\small\item\em timer1初始化函数 \end{DoxyCompactList}\item 
\mbox{\Hypertarget{keyboard_8h_a04e7d70591b56ea83a3cda7166220d4f}\label{keyboard_8h_a04e7d70591b56ea83a3cda7166220d4f}} 
void \mbox{\hyperlink{keyboard_8h_a04e7d70591b56ea83a3cda7166220d4f}{T\+M\+R1\+Func}} (void)
\begin{DoxyCompactList}\small\item\em 每次timer1中断后执行的函数，负责执行按键的全扫描及后续功能 \end{DoxyCompactList}\item 
\mbox{\Hypertarget{keyboard_8h_ad856d016886ca699c666f4095ef46f4d}\label{keyboard_8h_ad856d016886ca699c666f4095ef46f4d}} 
void \mbox{\hyperlink{keyboard_8h_ad856d016886ca699c666f4095ef46f4d}{Keyboard\+Init}} (void)
\begin{DoxyCompactList}\small\item\em 按键模块的初始化函数，需要初始化timer1和各引脚配置 \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{keyboard_8h_a4b497c98f7b20c7b5dcedc8e12a6d1dc}{Scan0}} (void)
\begin{DoxyCompactList}\small\item\em 按键全扫描的第一部分，负责判断两个功能键的按键情况 \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{keyboard_8h_af8d1a5a011b20e50fa755deec303dae6}{Scan1}} (void)
\begin{DoxyCompactList}\small\item\em 按键全扫描的第二部分，负责判断按键4、10、13、15、16的按键情况 \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{keyboard_8h_a12cf195630aa0a2e80e0eeb9d0383e51}{Scan2}} (void)
\begin{DoxyCompactList}\small\item\em 按键全扫描的第三部分，负责判断按键3、9、12、14的按键情况 \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{keyboard_8h_a520212d8d0bfcd5191af1fb488e87375}{Scan3}} (void)
\begin{DoxyCompactList}\small\item\em 按键全扫描的第四部分，负责判断按键2、8、11的按键情况 \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{keyboard_8h_a87d03c2a56454e2ff3627abe9fed1cce}{Scan4}} (void)
\begin{DoxyCompactList}\small\item\em 按键全扫描的第五部分，负责判断按键1、7的按键情况 \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
按键模块 

\begin{DoxyCopyright}{Copyright}
Copyright(c) 2021 Net\+Sec ~\newline
All rights reserved.
\end{DoxyCopyright}
\begin{DoxyDate}{Date}
2021-\/6-\/28 
\end{DoxyDate}
\begin{DoxyAuthor}{Author}
卢玮 
\end{DoxyAuthor}
\begin{DoxyNote}{Note}
按键模块的基本框架封装。需要注意的是，目前的所有按键情况都做了多 按键的判断处理。当出现同时多个按键按下时，不会进行任何处理动作
\end{DoxyNote}
\begin{DoxyDate}{Date}
2021-\/6-\/29 
\end{DoxyDate}
\begin{DoxyAuthor}{Author}
卢玮 
\end{DoxyAuthor}
\begin{DoxyNote}{Note}
将mode更改为enum类型，更加易读； 加入演奏模式下的全部逻辑（待测试）
\end{DoxyNote}
\begin{DoxyDate}{Date}
2021-\/7-\/3 
\end{DoxyDate}
\begin{DoxyAuthor}{Author}
董瑞华 
\end{DoxyAuthor}
\begin{DoxyNote}{Note}
注释变为\+Doxygen风格 
\end{DoxyNote}


\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902}\label{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902}} 
\index{keyboard.h@{keyboard.h}!work\_mode\_t@{work\_mode\_t}}
\index{work\_mode\_t@{work\_mode\_t}!keyboard.h@{keyboard.h}}
\doxysubsubsection{\texorpdfstring{work\_mode\_t}{work\_mode\_t}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902}{work\+\_\+mode\+\_\+t}}}



电子琴工作模式 

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{Play@{Play}!keyboard.h@{keyboard.h}}\index{keyboard.h@{keyboard.h}!Play@{Play}}}\mbox{\Hypertarget{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902a7f333a8f14b5817b34708afb007c91b8}\label{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902a7f333a8f14b5817b34708afb007c91b8}} 
Play&自由弹奏模式，值为0 \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Study@{Study}!keyboard.h@{keyboard.h}}\index{keyboard.h@{keyboard.h}!Study@{Study}}}\mbox{\Hypertarget{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902a8783a0d68f9430756749f185ac814bc5}\label{keyboard_8h_a11d32076d0e6a4fbf7ce0273a8ef1902a8783a0d68f9430756749f185ac814bc5}} 
Study&教学模式，值为1 \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{keyboard_8h_a4b497c98f7b20c7b5dcedc8e12a6d1dc}\label{keyboard_8h_a4b497c98f7b20c7b5dcedc8e12a6d1dc}} 
\index{keyboard.h@{keyboard.h}!Scan0@{Scan0}}
\index{Scan0@{Scan0}!keyboard.h@{keyboard.h}}
\doxysubsubsection{\texorpdfstring{Scan0()}{Scan0()}}
{\footnotesize\ttfamily uint8\+\_\+t Scan0 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



按键全扫描的第一部分，负责判断两个功能键的按键情况 

\begin{DoxyReturn}{Returns}
指示按键是否按下的flag 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & 有按键 \\
\hline
{\em 0} & 没有按键 \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{keyboard_8h_af8d1a5a011b20e50fa755deec303dae6}\label{keyboard_8h_af8d1a5a011b20e50fa755deec303dae6}} 
\index{keyboard.h@{keyboard.h}!Scan1@{Scan1}}
\index{Scan1@{Scan1}!keyboard.h@{keyboard.h}}
\doxysubsubsection{\texorpdfstring{Scan1()}{Scan1()}}
{\footnotesize\ttfamily uint8\+\_\+t Scan1 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



按键全扫描的第二部分，负责判断按键4、10、13、15、16的按键情况 

\begin{DoxyReturn}{Returns}
指示按键是否按下的flag 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & 有按键 \\
\hline
{\em 0} & 没有按键 \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{keyboard_8h_a12cf195630aa0a2e80e0eeb9d0383e51}\label{keyboard_8h_a12cf195630aa0a2e80e0eeb9d0383e51}} 
\index{keyboard.h@{keyboard.h}!Scan2@{Scan2}}
\index{Scan2@{Scan2}!keyboard.h@{keyboard.h}}
\doxysubsubsection{\texorpdfstring{Scan2()}{Scan2()}}
{\footnotesize\ttfamily uint8\+\_\+t Scan2 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



按键全扫描的第三部分，负责判断按键3、9、12、14的按键情况 

\begin{DoxyReturn}{Returns}
指示按键是否按下的flag 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & 有按键 \\
\hline
{\em 0} & 没有按键 \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{keyboard_8h_a520212d8d0bfcd5191af1fb488e87375}\label{keyboard_8h_a520212d8d0bfcd5191af1fb488e87375}} 
\index{keyboard.h@{keyboard.h}!Scan3@{Scan3}}
\index{Scan3@{Scan3}!keyboard.h@{keyboard.h}}
\doxysubsubsection{\texorpdfstring{Scan3()}{Scan3()}}
{\footnotesize\ttfamily uint8\+\_\+t Scan3 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



按键全扫描的第四部分，负责判断按键2、8、11的按键情况 

\begin{DoxyReturn}{Returns}
指示按键是否按下的flag 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & 有按键 \\
\hline
{\em 0} & 没有按键 \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{keyboard_8h_a87d03c2a56454e2ff3627abe9fed1cce}\label{keyboard_8h_a87d03c2a56454e2ff3627abe9fed1cce}} 
\index{keyboard.h@{keyboard.h}!Scan4@{Scan4}}
\index{Scan4@{Scan4}!keyboard.h@{keyboard.h}}
\doxysubsubsection{\texorpdfstring{Scan4()}{Scan4()}}
{\footnotesize\ttfamily uint8\+\_\+t Scan4 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



按键全扫描的第五部分，负责判断按键1、7的按键情况 

\begin{DoxyReturn}{Returns}
指示按键是否按下的flag 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & 有按键 \\
\hline
{\em 0} & 没有按键 \\
\hline
\end{DoxyRetVals}
